{% extends 'base.html' %} {% block title %}Usuários{% endblock %} {% block
content %}
<div class="search-cta">
    <input
        type="text"
        placeholder="Busque por Nome, E-mail ou ID do usuário"
        class="search"
        id="buscaUsuarios"
    />
    <button class="btn" onclick="openModal()">Cadastrar novo usuário</button>
</div>
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>E-mail</th>
            <th>Status</th>
            <th>Ações</th>
        </tr>
    </thead>
    <tbody id="userTableBody">
        {% for user in users %}
        <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.name }}</td>
            <td>{{ user.email }}</td>
            <td>
                <span
                    class="status {{ 'ativo' if user.is_active else 'inativo' }}"
                >
                    {{ 'Ativo' if user.is_active else 'Inativo' }}
                </span>
            </td>
            <td>
                <button
                    class="edit"
                    title="Editar usuário"
                    onclick="editUser('{{ user.id }}')"
                >
                    <span class="material-icons">edit</span>
                </button>

                <label class="switch" title="Ativar/Inativar usuário">
                    <input type="checkbox" {% if user.is_active %}checked{%
                    endif %} {% if user.id == current_user_id and user.is_admin
                    %}disabled{% else %} onchange="toggleUserStatus({{ user.id
                    }}, this.checked)" {% endif %} />

                    <span class="slider"></span>
                </label>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %} {% block extra_modal %}
<div id="modal" class="modal">
    <div class="modal-content">
        <div class="check">
            <h2>Cadastrar usuário</h2>
            <span class="close" onclick="closeModal()">&times;</span>
        </div>
        <div class="form">
            <div class="item_form">
                <label for="name">Nome</label>
                <input
                    type="text"
                    id="userName"
                    placeholder="Nome do usuário"
                    onblur="validateName()"
                    required
                />
                <span class="error-message" id="nameError"></span>
            </div>
            <div class="item_form">
                <label for="email">Email</label>
                <input
                    type="email"
                    id="userEmail"
                    placeholder="email_usuario@ifms.edu.br"
                    onblur="validateEmail()"
                    required
                />
                <span class="error-message" id="emailError"></span>
            </div>
            <div class="item_form">
                <label for="password">Senha</label>
                <input
                    type="password"
                    id="userPassword"
                    placeholder="Senha do usuário"
                    onblur="validatePassword()"
                    required
                />
                <span class="error-message" id="passwordError"></span>
            </div>

            <button onclick="saveUser()" id="save">Salvar alterações</button>
        </div>
    </div>
</div>
<script src="{{ url_for('static', filename='script.js') }}"></script>
{% endblock %}
